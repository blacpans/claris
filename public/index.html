<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Claris Live 🌸</title>
  <link rel="manifest" href="/manifest.json">
  <link rel="stylesheet" href="/style.css">
</head>
<body>
    <!-- Login Dialog -->
    <dialog id="login-overlay" class="login-dialog">
        <div class="login-card">
            <h1>🌸 Claris</h1>
            <p>おかえり！Clarisと話すにはログインが必要だよ！✨</p>
            <button id="login-button" class="btn btn-primary">
                Googleでログイン
            </button>
        </div>
    </dialog>
  <h1>Claris Live 🌸</h1>
  
  <div id="chat-container">
    <div id="chat-history">
      <div class="message ai">
        <p>こんにちは！<strong>Claris</strong>だよ🌸</p>
        <p>お話したいこと、何かある？✨</p>
      </div>
    </div>
  </div>

  <form id="input-area">
    <div id="live-indicator">
      <div class="live-dot"></div>
      Voice Call Active
    </div>
    
    <!-- Changed to Phone Icon for "Call" metaphor -->
    <button type="button" id="live-btn" aria-label="Toggle Voice Call">📞</button>
    
    <textarea id="message-input" placeholder="Message..." rows="1"></textarea>
    
    <button type="submit" id="send-btn">➤</button>
  </form>

  <div id="version-display"></div>

  <!-- Call Mode Overlay -->
  <dialog id="call-overlay" class="call-overlay">
    <div class="overlay-header">
      <h2>Claris Live 🌸</h2>
      <div id="status-text">Connecting...</div>
    </div>
    
    <canvas id="waveform"></canvas>

    <div class="overlay-controls">
      <!-- Mic Selector (Duplicated logic, synced in JS) -->
      <div class="overlay-mic-container">
         <select id="mic-selector-overlay" class="mic-selector overlay-selector">
            <!-- Populated by JS -->
         </select>
      </div>

      <button id="end-call-btn" class="end-call-btn" aria-label="End Call">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08c-.18-.17-.29-.42-.29-.7 0-.28.11-.53.29-.71C3.34 8.52 7.5 6.4 12 6.4c4.5 0 8.66 2.12 11.71 5.27.18.18.29.43.29.71 0 .28-.11.53-.29.7l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28-.79-.74-1.69-1.36-2.67-1.85-.33-.16-.56-.5-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z"/>
        </svg>
      </button>
    </div>
  </dialog>

  <div class="logs" id="logs" style="display:none;"></div>

  <script type="module" src="/js/app.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked@4.3.0/marked.min.js"></script>
</body>
</html>
